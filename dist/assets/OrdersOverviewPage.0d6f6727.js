import{o as c,x as w,m as u,d as N,l as y,b as C,g as a,t as M,_ as F,u as B,v as G,q as H,s as Y,w as P,c as j,y as O,p as h,F as T,h as q,e as K,a as S,A as Z,H as J,S as Q}from"./index.b346ebfa.js";import{u as V}from"./ordersStore.e95e47ef.js";import{A as W}from"./apiService.04c8dedd.js";import{_ as X}from"./RouteDetails.b4f9f7c3.js";import{T as z,_ as ee}from"./Tab.a4ecc7aa.js";import"./routeHelper.d039a0c6.js";function te(d,p){return c(),w("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},[u("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM4.332 8.027a6.012 6.012 0 011.912-2.706C6.512 5.73 6.974 6 7.5 6A1.5 1.5 0 019 7.5V8a2 2 0 004 0 2 2 0 011.523-1.943A5.977 5.977 0 0116 10c0 .34-.028.675-.083 1H15a2 2 0 00-2 2v2.197A5.973 5.973 0 0110 16v-2a2 2 0 00-2-2 2 2 0 01-2-2 2 2 0 00-1.668-1.973z","clip-rule":"evenodd"})])}function re(d,p){return c(),w("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},[u("path",{"fill-rule":"evenodd",d:"M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.601 2.566 1 1 0 11-1.885.666A5.002 5.002 0 005.999 7H9a1 1 0 010 2H4a1 1 0 01-1-1V3a1 1 0 011-1zm.008 9.057a1 1 0 011.276.61A5.002 5.002 0 0014.001 13H11a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0v-2.101a7.002 7.002 0 01-11.601-2.566 1 1 0 01.61-1.276z","clip-rule":"evenodd"})])}const oe={class:"top-0 right-0 left-0 z-50 md:inset-0 h-modal md:h-full"},ae={class:"relative w-full max-w-md h-full md:h-auto"},ne={class:"p-2 text-left"},se={class:"mb-2 text-lg font-bold text-gray-500 dark:text-gray-400"},de={class:"mb-5 text-md font-normal text-gray-500 dark:text-gray-400"},le={class:"text-center items-center pb-2 md:pb-0"},ie=N({name:"GMapDialog",props:{id:null,header:null,footer:null,buttonText:null},emits:["addRemoveOrderClicked","infoClicked"],setup(d,{emit:p}){const l=d,_=y(!0);function b(r){p("addRemoveOrderClicked",r),o(!1)}function o(r){_.value=r}return(r,m)=>{var v,n;return c(),C("div",oe,[a("div",ae,[a("div",ne,[a("h3",se,M(r.$t((v=d.header)!=null?v:r.$t("(Empty)"))),1),a("p",de,M(r.$t((n=d.footer)!=null?n:r.$t("(Empty)"))),1),a("div",le,[a("button",{type:"button",class:"text-white bg-green-600 hover:bg-green-800 focus:ring-4 focus:outline-none focus:ring-green-300 dark:focus:ring-green-800 rounded-lg text-sm px-4 py-2 text-center mr-2",onClick:m[0]||(m[0]=f=>b(d.id))},M(l.buttonText),1),a("button",{type:"button",class:"md:mr-0 mr-2 text-gray-500 bg-white hover:bg-gray-100 focus:ring-4 focus:outline-none focus:ring-gray-200 rounded-lg border border-gray-200 text-sm px-4 py-2 hover:text-gray-900 focus:z-10 dark:bg-gray-700 dark:text-gray-300 dark:border-gray-500 dark:hover:text-white dark:hover:bg-gray-600 dark:focus:ring-gray-600",onClick:m[1]||(m[1]=f=>r.$emit("infoClicked",d.id))},M(r.$t("Info")),1)])])])])}}});const ce={},ue={type:"range",min:"1",max:"100",value:"0",class:"range-slider shadow",oninput:"valueChanged(this)"};function pe(d,p){return c(),C("input",ue)}var ve=F(ce,[["render",pe],["__scopeId","data-v-a751c3c2"]]);const fe="M32 2C15.432 2 2 15.432 2 32c0 16.568 13.432 30 30 30s30-13.432 30-30C62 15.432 48.568 2 32 2zm6 46h-6.107V24.979c-2.232 2.086-4.863 3.629-7.893 4.629v-5.543c1.594-.521 3.326-1.512 5.195-2.967c1.871-1.455 3.152-3.156 3.848-5.098H38v32z",ge="M 20 5 L 20 10.46875 L 17 12.25 L 17 9.21875 L 15.5 10.15625 L 12 12.25 L 12 9.21875 L 10.5 10.15625 L 5.5 13.15625 L 5 13.4375 L 5 27 L 27 27 L 27 5 Z M 22 7 L 25 7 L 25 25 L 7 25 L 7 14.53125 L 10 12.75 L 10 15.78125 L 11.5 14.84375 L 15 12.75 L 15 15.78125 L 16.5 14.84375 L 21.5 11.84375 L 22 11.5625 Z M 9 17 L 9 19 L 11 19 L 11 17 Z M 13 17 L 13 19 L 15 19 L 15 17 Z M 17 17 L 17 19 L 19 19 L 19 17 Z M 21 17 L 21 19 L 23 19 L 23 17 Z M 9 21 L 9 23 L 11 23 L 11 21 Z M 13 21 L 13 23 L 15 23 L 15 21 Z M 17 21 L 17 23 L 19 23 L 19 21 Z M 21 21 L 21 23 L 23 23 L 23 21 Z";var me={NUMBER_1:fe,INDUSTRY:ge};const he={key:0},_e={class:"flex items-center"},be={class:"align-middle"},ke={class:"justify-center w-full pl-4 pr-4"},xe={class:"ml-auto"},Le={class:"align-middle"},ye=N({name:"OrdersOverview",props:{selectedRoute:null},emits:["mapIsReady","orderAdded","orderRemoved"],setup(d,{emit:p}){const l=d,_=new W(B()),b=G(),o=V();H();const{t:r}=Y(),m=y({lat:56.993048,lng:9.8212}),v=y();var n=y();const f=y(l.selectedRoute),i="/slc/dist/";P(()=>l.selectedRoute,(t,e)=>{f.value=t});const k=j(()=>n.value?n.value.map(e=>({id:e.orderId,position:{lat:e.latitude,lng:e.longitude},icon:L(e),clickable:!0,draggable:!1,infoWindow:{header:e.description,footer:r("Samples:")+" "+e.samples.length,buttonText:e.routeOrderNo?r("Remove"):r("Add")}})):[]);function x(t,e){return String(t).padStart(e,"0")}const L=t=>t.routeOrderNo?i+"images/markers/black"+x(t.routeOrderNo,2)+".png":{path:me.INDUSTRY,scale:1,strokeColor:"black",strokeOpacity:.1,fillColor:"black",fillOpacity:1,anchor:{x:15,y:30}};o.$persistedState.isReady().then(async()=>{if(o.orders)n.value=o.orders;else{const t=await _.get("orders");n.value=t,o.orders=n.value}});const $=async t=>{var I;let e=(I=n.value)==null?void 0:I.filter(R=>R.orderId==t)[0];if(e&&n.value&&f.value)if(e!=null&&e.routeOrderNo){e.routeOrderNo=void 0;let R=1;n.value.filter(g=>g.routeOrderNo).sort((g,s)=>g.routeOrderNo-s.routeOrderNo).forEach(g=>{g.routeOrderNo=R++}),f.value.orders=f.value.orders.filter(g=>g.orderId!=t),p("orderRemoved",t)}else e.routeOrderNo=f.value.orders.length+1,p("orderAdded",t);v.value=null},D=async t=>{b.push({name:"Order",params:{orderId:t.toString()}})},A=async()=>{v.value=null},E=async(t,e)=>{v.value=t.id};return(t,e)=>{const I=O("GMapInfoWindow"),R=O("GMapMarker"),g=O("GMapMap");return c(),C(T,null,[u(g,{class:"pb-2",center:m.value,zoom:9,options:{gestureHandling:"greedy"},"map-type-id":"terrain",onClick:A,onIdle:e[0]||(e[0]=s=>p("mapIsReady"))},{default:h(()=>[(c(!0),C(T,null,q(S(k),(s,U)=>(c(),w(R,{key:U,position:s.position,clickable:s.clickable,draggable:s.draggable,icon:s.icon,onClick:Ce=>E(s)},{default:h(()=>[v.value===s.id?(c(),C("div",he,[u(I,{"v-if":v.value===s.id,closeclick:!0,onCloseclick:A},{default:h(()=>[u(ie,{id:s.id,header:s.infoWindow.header,footer:s.infoWindow.footer,"button-text":s.infoWindow.buttonText,onAddRemoveOrderClicked:$,onInfoClicked:D},null,8,["id","header","footer","button-text"])]),_:2},1032,["v-if"])])):K("",!0)]),_:2},1032,["position","clickable","draggable","icon","onClick"]))),128))]),_:1},8,["center"]),a("div",_e,[a("div",null,[a("button",be,[(c(),w(Z(S(te)),{class:"text-indigo-600 w-6 h-6"}))])]),a("div",ke,[u(ve,{class:"w-full align-middle"})]),a("div",xe,[a("button",Le,[(c(),w(Z(S(re)),{class:"text-indigo-600 w-6 h-6"}))])])])],64)}}}),we=a("div",null,"FALLBACK",-1),Re={class:"w-screen max-w-full"},Ae=N({name:"OrdersOverviewPage",setup(d){const p=J.exports.useLoading();G();const l=V(),_=H();new W(B());const b=y(0),o=y(),r=i=>{var x;const k=(x=l.orders)==null?void 0:x.filter(L=>L.orderId==i)[0];o.value&&k&&o.value.orders.push(k)},m=i=>{var x;const k=(x=l.orders)==null?void 0:x.filter(L=>L.orderId==i)[0];if(o.value&&k){const L=o.value.orders.filter($=>$.orderId!=i);o.value.orders=L}};l.$persistedState.isReady().then(async()=>{l.selectedTabIndex&&(b.value=l.selectedTabIndex,l.selectedTabIndex=0)}),_.$persistedState.isReady().then(async()=>{_.selectedRoute&&(o.value=_.selectedRoute)});const v=async i=>{b.value=i},n=p.show({isFullPage:!0,loader:"dots",canCancel:!1});setTimeout(()=>{n.hide()},5e3);const f=async()=>{n.hide()};return(i,k)=>(c(),w(Q,null,{fallback:h(()=>[we]),default:h(()=>[a("div",Re,[u(ee,{"selected-tab-index":b.value,classes:"mb-2",onSelectedTabChanged:v},{default:h(()=>[u(z,{title:i.$t("Overview")},{default:h(()=>[u(ye,{"selected-route":o.value,onMapIsReady:f,onOrderAdded:r,onOrderRemoved:m},null,8,["selected-route"])]),_:1},8,["title"]),u(z,{title:i.$t("Route details")},{default:h(()=>[u(X,{"selected-route":o.value,"show-unsaved-route":!0,editable:!0},null,8,["selected-route"])]),_:1},8,["title"])]),_:1},8,["selected-tab-index"])])]),_:1}))}});export{Ae as default};
