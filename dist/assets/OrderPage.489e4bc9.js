import{_ as W,d as X,q as Y,s as ee,c as V,l as v,u as te,b as y,m as t,p as z,F as _,O as ae,P as oe,Q as le,y as F,o as d,a as k,x,g as s,e as E,h as se,N as q}from"./index.8957af59.js";import{u as re}from"./ordersStore.0ee79482.js";import{u as ne}from"./customersStore.c3888f7b.js";import{A as ie,P as de,a as l,_ as u}from"./apiService.4d37c104.js";function ue(r){const n=r.toLocaleDateString(void 0,{year:"numeric",month:"2-digit",day:"2-digit"}),i=r.toLocaleTimeString(void 0,{hour:"2-digit",minute:"2-digit"});return console.log(n+" "+i),n+" "+i}const Q=r=>(ae("data-v-f81a9db0"),r=r(),oe(),r),ce=Q(()=>s("div",{class:"hidden lg:block"},"big screen not supported yet",-1)),pe=Q(()=>s("thead",{class:"border-t-0"},null,-1)),me={class:"bg-white"},he={class:"bg-white"},fe={class:"bg-white"},ge={class:"bg-white"},ve={class:"bg-white"},ye={class:"bg-white"},_e=X({name:"OrderPage",setup(r){const n=re(),i=Y(),U=ne();ee();const Z=le(),S=V(()=>{var e,p,f,g;return{lat:(p=(e=a.value)==null?void 0:e.latitude)!=null?p:0,lng:(g=(f=a.value)==null?void 0:f.longitude)!=null?g:0}}),h=v(),a=v(),o=v(),j=new ie(te()),c=v(),b=V(()=>{const e=Z.path.split("/");return parseInt(e[e.length-1])}),H=e=>{c.value=e},J=()=>{a.value&&h.value&&(n.selectedTabIndex=1,a.value.routeOrderNo=h.value.orders.length+1,h.value.orders.push(a.value),q.push("/scheduling/orders"))},K=e=>{q.push({name:"OrderSample",params:{orderId:b.value.toString(),sampleId:e.toString()}})};return i.selectedRoute&&(c.value=new Date(i.selectedRoute.scheduledSampling.toString()),h.value=i.selectedRoute),n.$persistedState.isReady().then(async()=>{if(n.orders){const e=n.orders.filter(p=>p.orderId==b.value);a.value=e[0]}else{const e=await j.get(`orders/${b.value}`);a.value=e}a.value.samples=[{sampleId:22,createdBy:"ML",scope:"Group A analysis",type:"Drinking water assesment",label:"Prefilter #1",place:{name:"Martins Place",latitude:57,longitude:9,samplesCount:1},packaging:[]}],U.$persistedState.isReady().then(async()=>{o.value={city:"Aalborg",customerId:2,email:"martin.lykke@sgs.com",mobile:"+4531503854",name:"Martin",phone:"+4531503854",address:"S\xF8parken 35"}})}),(e,p)=>{const f=F("GMapMarker"),g=F("GMapMap");return d(),y(_,null,[ce,t(de,{class:"lg:hidden"},{content:z(()=>{var w,C,$,I,M,R,A,P,G,O,T,D,B,N,L;return[pe,t(g,{center:k(S),zoom:16,options:{mapTypeControl:!1,scaleControl:!1,streetViewControl:!1,rotateControl:!1,fullscreenControl:!1,draggable:!1,scrollwheel:!1,disableDoubleClickZoom:!0,zoomControl:!1,clickableIcons:!1,keyboardShortcuts:!1},"map-type-id":"terrain",class:"w-full h-32"},{default:z(()=>[(d(),x(f,{key:1,position:k(S)},null,8,["position"]))]),_:1},8,["center"]),s("tbody",me,[t(l,{clickable:!0,header:(w=o.value)==null?void 0:w.name,footer1:(C=o.value)==null?void 0:C.address,footer2:($=o.value)==null?void 0:$.city,hyperlink:encodeURI("https://www.google.com/maps/dir/?api=1&destination="+((I=a.value)==null?void 0:I.latitude)+","+((M=a.value)==null?void 0:M.longitude)+"&travelmode=driving")},null,8,["header","footer1","footer2","hyperlink"])]),t(u,{title:e.$t("Contact:")+" "+((R=o.value)==null?void 0:R.name)},null,8,["title"]),s("tbody",he,[t(l,{header:e.$t("Telephone"),footer1:(A=o.value)==null?void 0:A.phone,hyperlink:`tel:${(P=o.value)==null?void 0:P.phone}`},null,8,["header","footer1","hyperlink"]),t(l,{header:e.$t("Mobile"),footer1:(G=o.value)==null?void 0:G.mobile,hyperlink:`tel:${(O=o.value)==null?void 0:O.mobile}`},null,8,["header","footer1","hyperlink"]),t(l,{header:e.$t("E-mail"),footer1:(T=o.value)==null?void 0:T.email,hyperlink:`mailto: ${(D=o.value)==null?void 0:D.email}`},null,8,["header","footer1","hyperlink"])]),t(u,{title:e.$t("Sampling notes:")},null,8,["title"]),s("tbody",fe,[t(l,{"text-area":""})]),(B=a.value)!=null&&B.routeGuid?E("",!0):(d(),y(_,{key:0},[t(u,{title:e.$t("Sampling:")},null,8,["title"]),s("tbody",ge,[t(l,{header:e.$t("Select sampling date and time"),footer1:c.value?k(ue)(c.value):"","date-input":new Date,"date-initial":c.value,onDateChanged:H},null,8,["header","footer1","date-input","date-initial"])])],64)),t(u,{title:e.$t("Samples:")},null,8,["title"]),s("tbody",ve,[(d(!0),y(_,null,se((N=a.value)==null?void 0:N.samples,m=>(d(),x(l,{key:m.sampleId,header:m.place.name,footer1:m.type,footer2:m.label,clickable:!0,onRowClicked:be=>K(m.sampleId)},null,8,["header","footer1","footer2","onRowClicked"]))),128))]),(L=a.value)!=null&&L.routeGuid?E("",!0):(d(),y(_,{key:1},[t(u,{title:e.$t("Add order")},null,8,["title"]),s("tbody",ye,[t(l,{header:e.$t("Add to route"),footer1:e.$t("Adds order to route with the selected sampling date"),clickable:!0,onRowClicked:J},null,8,["header","footer1"])])],64)),t(u)]}),_:1})],64)}}});var $e=W(_e,[["__scopeId","data-v-f81a9db0"]]);export{$e as default};
