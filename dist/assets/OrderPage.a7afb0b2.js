import{_ as H,d as J,q as K,s as W,c as G,l as v,u as X,b as B,m as t,p as N,F as z,N as Y,O as ee,P as te,y as F,o as f,a as b,x as L,g as s,h as oe,Q as V}from"./index.e0e2b8ab.js";import{u as ae}from"./ordersStore.11b9e3dd.js";import{u as le}from"./customersStore.6b7c19b1.js";import{A as se,P as re,a as l,_ as d}from"./apiService.44c06e37.js";function ne(r){const n=r.toLocaleDateString(void 0,{year:"numeric",month:"2-digit",day:"2-digit"}),i=r.toLocaleTimeString(void 0,{hour:"2-digit",minute:"2-digit"});return console.log(n+" "+i),n+" "+i}const x=r=>(Y("data-v-b3176472"),r=r(),ee(),r),ie=x(()=>s("div",{class:"hidden lg:block"},"big screen not supported yet",-1)),de=x(()=>s("thead",{class:"border-t-0"},null,-1)),ue={class:"bg-white"},ce={class:"bg-white"},pe={class:"bg-white"},me={class:"bg-white"},he={class:"bg-white"},ge={class:"bg-white"},ve=J({name:"OrderPage",setup(r){const n=ae(),i=K(),E=le();W();const q=te(),y=G(()=>{var e,c,h,g;return{lat:(c=(e=o.value)==null?void 0:e.latitude)!=null?c:0,lng:(g=(h=o.value)==null?void 0:h.longitude)!=null?g:0}}),m=v(),o=v(),a=v(),Q=new se(X()),u=v(),_=G(()=>{const e=q.path.split("/");return parseInt(e[e.length-1])}),U=e=>{u.value=e},Z=()=>{o.value&&m.value&&(n.selectedTabIndex=1,o.value.routeOrderNo=m.value.orders.length+1,m.value.orders.push(o.value),V.push("/scheduling/orders"))},j=e=>{V.push({name:"OrderSample",params:{orderId:_.value.toString(),sampleId:e.toString()}})};return i.selectedRoute&&(u.value=new Date(i.selectedRoute.scheduledSampling.toString()),m.value=i.selectedRoute),n.$persistedState.isReady().then(async()=>{if(n.orders){const e=n.orders.filter(c=>c.orderId==_.value);o.value=e[0]}else{const e=await Q.get(`orders/${_.value}`);o.value=e}o.value.samples=[{sampleId:22,type:"Drinking water assesment",label:"Group A analysis",place:{name:"Martins Place",latitude:57,longitude:9,samplesCount:1}}],E.$persistedState.isReady().then(async()=>{a.value={city:"Aalborg",customerId:2,email:"martin.lykke@sgs.com",mobile:"+4531503854",name:"Martin",phone:"+4531503854",address:"S\xF8parken 35"}})}),(e,c)=>{const h=F("GMapMarker"),g=F("GMapMap");return f(),B(z,null,[ie,t(re,{class:"lg:hidden"},{content:N(()=>{var k,S,w,C,$,I,R,M,A,O,P,T,D;return[de,t(g,{center:b(y),zoom:16,options:{mapTypeControl:!1,scaleControl:!1,streetViewControl:!1,rotateControl:!1,fullscreenControl:!1,draggable:!1,scrollwheel:!1,disableDoubleClickZoom:!0,zoomControl:!1,clickableIcons:!1,keyboardShortcuts:!1},"map-type-id":"terrain",class:"w-full h-32"},{default:N(()=>[(f(),L(h,{key:1,position:b(y)},null,8,["position"]))]),_:1},8,["center"]),s("tbody",ue,[t(l,{clickable:!0,header:(k=a.value)==null?void 0:k.name,footer1:(S=a.value)==null?void 0:S.address,footer2:(w=a.value)==null?void 0:w.city,hyperlink:encodeURI("https://www.google.com/maps/dir/?api=1&destination="+((C=o.value)==null?void 0:C.latitude)+","+(($=o.value)==null?void 0:$.longitude)+"&travelmode=driving")},null,8,["header","footer1","footer2","hyperlink"])]),t(d,{title:e.$t("Contact:")+" "+((I=a.value)==null?void 0:I.name)},null,8,["title"]),s("tbody",ce,[t(l,{header:e.$t("Telephone"),footer1:(R=a.value)==null?void 0:R.phone,hyperlink:`tel:${(M=a.value)==null?void 0:M.phone}`},null,8,["header","footer1","hyperlink"]),t(l,{header:e.$t("Mobile"),footer1:(A=a.value)==null?void 0:A.mobile,hyperlink:`tel:${(O=a.value)==null?void 0:O.mobile}`},null,8,["header","footer1","hyperlink"]),t(l,{header:e.$t("E-mail"),footer1:(P=a.value)==null?void 0:P.email,hyperlink:`mailto: ${(T=a.value)==null?void 0:T.email}`},null,8,["header","footer1","hyperlink"])]),t(d,{title:e.$t("Sampling notes:")},null,8,["title"]),s("tbody",pe,[t(l,{"text-area":!0})]),t(d,{title:e.$t("Sampling:")},null,8,["title"]),s("tbody",me,[t(l,{header:e.$t("Select sampling date and time"),footer1:u.value?b(ne)(u.value):"","date-input":!0,"date-initial":u.value,onDateChanged:U},null,8,["header","footer1","date-initial"])]),t(d,{title:e.$t("Samples:")},null,8,["title"]),s("tbody",he,[(f(!0),B(z,null,oe((D=o.value)==null?void 0:D.samples,p=>(f(),L(l,{key:p.sampleId,header:p.place.name,footer1:p.type,footer2:p.label,clickable:!0,onRowClicked:fe=>j(p.sampleId)},null,8,["header","footer1","footer2","onRowClicked"]))),128))]),t(d,{title:e.$t("Add order")},null,8,["title"]),s("tbody",ge,[t(l,{header:e.$t("Add to route"),footer1:e.$t("Adds order to route with the selected sampling date"),clickable:!0,onRowClicked:Z},null,8,["header","footer1"])]),t(d)]}),_:1})],64)}}});var Se=H(ve,[["__scopeId","data-v-b3176472"]]);export{Se as default};
