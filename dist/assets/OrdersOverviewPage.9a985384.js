import{o as a,x as k,m as r,d as A,l as x,b,g as e,t as S,_ as j,u as B,v as D,q as H,s as q,w as K,c as V,y as z,p as m,F as T,h as P,e as J,a as I,A as Z,H as Q,S as X}from"./index.e8935084.js";import{u as U}from"./ordersStore.c9c52bfd.js";import{A as W,_ as O,a as M,P as ee}from"./apiService.6f9bb616.js";import{_ as G,a as te}from"./Tab.2ba3c87a.js";function oe(i,c){return a(),k("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},[r("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM4.332 8.027a6.012 6.012 0 011.912-2.706C6.512 5.73 6.974 6 7.5 6A1.5 1.5 0 019 7.5V8a2 2 0 004 0 2 2 0 011.523-1.943A5.977 5.977 0 0116 10c0 .34-.028.675-.083 1H15a2 2 0 00-2 2v2.197A5.973 5.973 0 0110 16v-2a2 2 0 00-2-2 2 2 0 01-2-2 2 2 0 00-1.668-1.973z","clip-rule":"evenodd"})])}function re(i,c){return a(),k("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},[r("path",{"fill-rule":"evenodd",d:"M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z","clip-rule":"evenodd"})])}function se(i,c){return a(),k("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},[r("path",{"fill-rule":"evenodd",d:"M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.601 2.566 1 1 0 11-1.885.666A5.002 5.002 0 005.999 7H9a1 1 0 010 2H4a1 1 0 01-1-1V3a1 1 0 011-1zm.008 9.057a1 1 0 011.276.61A5.002 5.002 0 0014.001 13H11a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0v-2.101a7.002 7.002 0 01-11.601-2.566 1 1 0 01.61-1.276z","clip-rule":"evenodd"})])}const ae={class:"top-0 right-0 left-0 z-50 md:inset-0 h-modal md:h-full"},ne={class:"relative w-full max-w-md h-full md:h-auto"},le={class:"p-2 text-left"},de={class:"mb-2 text-lg font-bold text-gray-500 dark:text-gray-400"},ie={class:"mb-5 text-md font-normal text-gray-500 dark:text-gray-400"},ce={class:"text-center items-center pb-2 md:pb-0"},ue=A({name:"GMapDialog",props:{id:null,header:null,footer:null,buttonText:null},emits:["addToRouteClicked","infoClicked"],setup(i,{emit:c}){const n=i,u=x(!0);function _(l){c("addToRouteClicked",l),o(!1)}function o(l){u.value=l}return(l,v)=>(a(),b("div",ae,[e("div",ne,[e("div",le,[e("h3",de,S(l.$t(i.header)),1),e("p",ie,S(l.$t(i.footer)),1),e("div",ce,[e("button",{type:"button",class:"text-white bg-green-600 hover:bg-green-800 focus:ring-4 focus:outline-none focus:ring-green-300 dark:focus:ring-green-800 rounded-lg text-sm px-4 py-2 text-center mr-2",onClick:v[0]||(v[0]=p=>_(i.id))},S(n.buttonText),1),e("button",{type:"button",class:"md:mr-0 mr-2 text-gray-500 bg-white hover:bg-gray-100 focus:ring-4 focus:outline-none focus:ring-gray-200 rounded-lg border border-gray-200 text-sm px-4 py-2 hover:text-gray-900 focus:z-10 dark:bg-gray-700 dark:text-gray-300 dark:border-gray-500 dark:hover:text-white dark:hover:bg-gray-600 dark:focus:ring-gray-600",onClick:v[1]||(v[1]=p=>l.$emit("infoClicked",i.id))},S(l.$t("Info")),1)])])])]))}});const pe={},fe={type:"range",min:"1",max:"100",value:"0",class:"range-slider shadow",oninput:"valueChanged(this)"};function ve(i,c){return a(),b("input",fe)}var ge=j(pe,[["render",ve],["__scopeId","data-v-a751c3c2"]]);const he="M32 2C15.432 2 2 15.432 2 32c0 16.568 13.432 30 30 30s30-13.432 30-30C62 15.432 48.568 2 32 2zm6 46h-6.107V24.979c-2.232 2.086-4.863 3.629-7.893 4.629v-5.543c1.594-.521 3.326-1.512 5.195-2.967c1.871-1.455 3.152-3.156 3.848-5.098H38v32z",me="M 20 5 L 20 10.46875 L 17 12.25 L 17 9.21875 L 15.5 10.15625 L 12 12.25 L 12 9.21875 L 10.5 10.15625 L 5.5 13.15625 L 5 13.4375 L 5 27 L 27 27 L 27 5 Z M 22 7 L 25 7 L 25 25 L 7 25 L 7 14.53125 L 10 12.75 L 10 15.78125 L 11.5 14.84375 L 15 12.75 L 15 15.78125 L 16.5 14.84375 L 21.5 11.84375 L 22 11.5625 Z M 9 17 L 9 19 L 11 19 L 11 17 Z M 13 17 L 13 19 L 15 19 L 15 17 Z M 17 17 L 17 19 L 19 19 L 19 17 Z M 21 17 L 21 19 L 23 19 L 23 17 Z M 9 21 L 9 23 L 11 23 L 11 21 Z M 13 21 L 13 23 L 15 23 L 15 21 Z M 17 21 L 17 23 L 19 23 L 19 21 Z M 21 21 L 21 23 L 23 23 L 23 21 Z";var _e={NUMBER_1:he,INDUSTRY:me};const be={key:0},ye={class:"grid grid-cols-6 gap-7 items-center absolute w-full bottom-0 right-0",style:{"padding-bottom":"9.5rem"}},we={class:"col-span-4"},xe={class:"justify-self-end"},ke=A({name:"OrdersOverview",props:{selectedRoute:null},emits:["mapIsReady","orderAdded","orderRemoved"],setup(i,{emit:c}){const n=i,u=new W(B()),_=D(),o=U();H();const{t:l}=q(),v=x({lat:56.993048,lng:9.8212}),p=x();var f=x();const w=x(n.selectedRoute);K(()=>n.selectedRoute,(t,s)=>{w.value=t});const g=V(()=>f.value?f.value.map(t=>({id:t.orderId,position:{lat:t.latitude,lng:t.longitude},icon:L(t),clickable:!0,draggable:!1,infoWindow:{header:t.description,footer:l("Samples:")+" "+t.samples.map(s=>s.place).reduce((s,R)=>s+R.samplesCount,0),buttonText:t.routeOrderNo?l("Remove"):l("Add")}})):[]);function h(t,s){return String(t).padStart(s,"0")}const L=t=>t.routeOrderNo?"/images/markers/black"+h(t.routeOrderNo,2)+".png":{path:_e.INDUSTRY,scale:1,strokeColor:"black",strokeOpacity:.1,fillColor:"black",fillOpacity:1,anchor:{x:15,y:30}};o.$persistedState.isReady().then(async()=>{if(o.orders)f.value=o.orders;else{const t=await u.get("orders");f.value=t,o.orders=f.value}});const y=async t=>{var R;let s=(R=f.value)==null?void 0:R.filter(C=>C.orderId==t)[0];if(s&&f.value&&w.value)if(s!=null&&s.routeOrderNo){s.routeOrderNo=void 0;let C=1;f.value.filter($=>$.routeOrderNo).sort(($,d)=>$.routeOrderNo-d.routeOrderNo).forEach($=>{$.routeOrderNo=C++}),c("orderRemoved",t)}else console.error(w.value.waypoints.length),s.routeOrderNo=w.value.waypoints.length+1,c("orderAdded",t);p.value=null},N=async t=>{_.push({name:"Order",params:{orderId:t.toString()}})},F=async()=>{p.value=null},E=async(t,s)=>{p.value=t.id};return(t,s)=>{const R=z("GMapInfoWindow"),C=z("GMapMarker"),$=z("GMapMap");return a(),b(T,null,[r($,{class:"pb-48",center:v.value,zoom:9,options:{gestureHandling:"greedy"},"map-type-id":"terrain",onClick:F,onIdle:s[0]||(s[0]=d=>c("mapIsReady"))},{default:m(()=>[(a(!0),b(T,null,P(I(g),(d,Y)=>(a(),k(C,{key:Y,position:d.position,clickable:d.clickable,draggable:d.draggable,icon:d.icon,onClick:De=>E(d)},{default:m(()=>[p.value===d.id?(a(),b("div",be,[r(R,{"v-if":p.value===d.id,closeclick:!0,onCloseclick:F},{default:m(()=>[r(ue,{id:d.id,header:d.infoWindow.header,footer:d.infoWindow.footer,"button-text":d.infoWindow.buttonText,onAddToRouteClicked:y,onInfoClicked:N},null,8,["id","header","footer","button-text"])]),_:2},1032,["v-if"])])):J("",!0)]),_:2},1032,["position","clickable","draggable","icon","onClick"]))),128))]),_:1},8,["center"]),e("div",ye,[e("button",null,[(a(),k(Z(I(oe)),{class:"text-indigo-600 w-6 h-6"}))]),e("div",we,[r(ge,{class:"w-full"})]),e("button",xe,[(a(),k(Z(I(se)),{class:"text-indigo-600 w-6 h-6"}))])])],64)}}});const Le=e("div",{class:"hidden lg:block"},"big screen not supported yet",-1),$e={class:"bg-white"},Re={key:0,class:"bg-white"},Ce=e("hr",{class:"border"},null,-1),Me=e("div",{class:"absolute ml-5 w-5"},[e("div",{class:"bg-gray-300 w-1 h-1 rounded-full mt-1 m-auto place-self-center"}),e("div",{class:"bg-gray-300 w-3 h-3 rounded-full mt-1 m-auto place-self-center"}),e("div",{style:{},class:"bg-gray-300 w-1 h-1 rounded-full mt-1 m-auto place-self-center"}),e("div",{class:"bg-gray-300 w-1 h-1 rounded-full mt-1 m-auto place-self-center"}),e("div",{class:"bg-gray-300 w-1 h-1 rounded-full mt-1 m-auto place-self-center"})],-1),Ie=e("hr",{class:"border ml-6"},null,-1),Se={class:"absolute ml-5 w-5"},Oe=e("div",{class:"bg-gray-300 w-1 h-1 rounded-full mt-1 m-auto place-self-center"},null,-1),Te=e("hr",{class:"border"},null,-1),Ae={key:1,class:"bg-white"},Ne={class:"bg-white"},ze=A({name:"RouteDetails",props:{selectedRoute:null},setup(i){const c=new W(B());D();const n=H(),u=x(),_=V(()=>{var o;return(o=u.value)!=null&&o.waypoints?u.value.waypoints.length>0:!1});return n.$persistedState.isReady().then(async()=>{n.selectedRoute||c.get("routes/{}"),u.value=n.selectedRoute}),(o,l)=>(a(),b(T,null,[Le,r(ee,{class:"lg:hidden"},{content:m(()=>{var v,p;return[r(O,{title:o.$t("Route")},null,8,["title"]),e("tbody",$e,[r(M,{header:(v=u.value)==null?void 0:v.description,footer1:"Footer"},null,8,["header"])]),r(O,{title:o.$t("Directions")},null,8,["title"]),I(_)?(a(),b("tbody",Re,[(a(!0),b(T,null,P((p=u.value)==null?void 0:p.waypoints,(f,w)=>(a(),b("div",{key:w},[Ce,r(M,{header:"First waypoint",footer1:"Address",footer2:"Samples collected","no-borders":!0,styles:"padding-left:1.5rem"},{default:m(()=>[Me]),_:1},8,["styles"])]))),128)),Ie,r(M,{header:"Home",footer1:"Address","no-borders":!0,styles:"padding-left:1.5rem"},{default:m(()=>[e("div",Se,[Oe,(a(),k(Z(I(re)),{class:"text-gray-300 w-5 h-5 mt-1 m-auto place-self-center"}))])]),_:1},8,["styles"]),Te])):(a(),b("tbody",Ae,[r(M,{header:"No directions to show",footer1:"Add orders to the route in the overview"})])),r(O,{title:o.$t("Packaging")},null,8,["title"]),e("tbody",Ne,[r(M,{header:"First bottle",footer1:"description"})]),r(O)]}),_:1})],64))}}),Ze=e("div",null,"FALLBACK",-1),Be={class:"w-screen max-w-full"},Ve=A({name:"OrdersOverviewPage",setup(i){const c=Q.exports.useLoading();D();const n=U(),u=H();new W(B());const _=x(0),o=x(),l=g=>{var L;const h=(L=n.orders)==null?void 0:L.filter(y=>y.orderId==g)[0];o.value&&h&&o.value.waypoints.push({orderId:h.orderId,contact:h.contact,lat:h.latitude,lon:h.longitude,places:h.samples.map(y=>y.place)})},v=g=>{var L;const h=(L=n.orders)==null?void 0:L.filter(y=>y.orderId==g)[0];if(o.value&&h){const y=o.value.waypoints.filter(N=>N.orderId==g);o.value.waypoints=y}};n.$persistedState.isReady().then(async()=>{n.selectedTabIndex&&(_.value=n.selectedTabIndex,n.selectedTabIndex=0)}),_.value=0,u.$persistedState.isReady().then(async()=>{u.selectedRoute&&(o.value=u.selectedRoute)});const p=async g=>{_.value=g},f=c.show({isFullPage:!0,loader:"dots",canCancel:!1});setTimeout(()=>{f.hide()},5e3);const w=async()=>{f.hide()};return(g,h)=>(a(),k(X,null,{fallback:m(()=>[Ze]),default:m(()=>[e("div",Be,[r(te,{"selected-tab-index":_.value,classes:"mb-2",onSelectedTabChanged:p},{default:m(()=>[r(G,{title:g.$t("Overview")},{default:m(()=>[r(ke,{"selected-route":o.value,onMapIsReady:w,onOrderAdded:l,onOrderRemoved:v},null,8,["selected-route"])]),_:1},8,["title"]),r(G,{title:g.$t("Route details")},{default:m(()=>[r(ze,{"selected-route":o.value},null,8,["selected-route"])]),_:1},8,["title"])]),_:1},8,["selected-tab-index"])])]),_:1}))}});export{Ve as default};
